{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="promocao-container">
  <h2>ğŸ¯ Gerenciar PromoÃ§Ãµes</h2>

  <!-- FormulÃ¡rio para criar nova promoÃ§Ã£o -->
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group">
      {{ form.titulo.label_tag }}<br>
      {{ form.titulo }}
    </div>

    <div class="form-group">
      {{ form.descricao.label_tag }}<br>
      {{ form.descricao }}
    </div>

    <div class="form-group">
      {{ form.imagem.label_tag }}<br>
      {{ form.imagem }}
    </div>

    <div class="form-group">
      {{ form.pizzas.label_tag }}<br>
      <div style="max-height: 150px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 8px;">
        {{ form.pizzas }}
      </div>
    </div>

    <div class="form-group">
      {{ form.bebidas.label_tag }}<br>
      <div style="max-height: 150px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 8px;">
        {{ form.bebidas }}
      </div>
    </div>

    <div class="form-group">
      {{ form.ativa }} {{ form.ativa.label_tag }}
    </div>

    <button type="submit" class="submit-btn">â• Criar PromoÃ§Ã£o</button>
  </form>

  <hr>

  <h3>ğŸ“‹ PromoÃ§Ãµes Atuais</h3>
  <ul style="list-style: none; padding: 0;">
    {% for promo in promocoes %}
      <li style="margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #ddd;">
        <strong>{{ promo.titulo }}</strong> â€”
        {% if promo.ativa %}âœ… Ativa{% else %}â›” Inativa{% endif %}<br>

        <img src="{{ promo.imagem.url }}" alt="{{ promo.titulo }}" style="max-width: 200px; border-radius: 8px; margin-top: 10px;"><br>

        {% if promo.pizzas.all %}
          <p>ğŸ• <strong>Pizzas:</strong>
            {{ promo.pizzas.all|join:", " }}
          </p>
        {% endif %}

        {% if promo.bebidas.all %}
          <p>ğŸ¥¤ <strong>Bebidas:</strong>
            {{ promo.bebidas.all|join:", " }}
          </p>
        {% endif %}

        <a href="{% url 'pedido_promocao' promo.id %}" class="btn-editar" style="margin-top: 10px; display: inline-block;">ğŸ‘ Visualizar como cliente</a>

        <form method="post" action="{% url 'excluir_promocao' promo.id %}" style="display:inline-block; margin-left: 10px;">
          {% csrf_token %}
          <button type="submit" class="btn-deletar" onclick="return confirm('Tem certeza que deseja excluir esta promoÃ§Ã£o?')">ğŸ—‘ Excluir</button>
        </form>
      </li>
    {% empty %}
      <p>Nenhuma promoÃ§Ã£o cadastrada.</p>
    {% endfor %}
  </ul>
</div>
{% endblock %}
