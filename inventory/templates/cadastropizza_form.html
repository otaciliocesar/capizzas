{% extends 'base.html' %}
{% load static %}
{% block content %}  
<div class="cadastro-wrapper-coluna">
        <!-- Formul√°rio de cadastro -->
        <div class="registro-container">
            <h2>Cadastrar Pizza</h2>
            {% if error %}
            <p class="error">{{ error }}</p>
            {% endif %}
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit">Registrar</button>
            </form>
        </div>

        <!-- Lista de pizzas -->
        <div class="lista-pizzas">
            <h2>Pizzas Cadastradas</h2>

            <input type="text" id="filtro" placeholder="üîç Buscar pizza..." class="filtro-input">

            <ul id="lista-pizzas">
                {% for pizza in pizzas %}
                <li class="pizza-item">
                    <strong>{{ pizza.nome }}</strong><br>
                    {{ pizza.ingredientes }}<br>
                    R$ {{ pizza.preco }}<br>
                    {% if pizza.imagem %}
                    <img src="{{ pizza.imagem.url }}" alt="{{ pizza.nome }}" width="100"><br>
                    {% endif %}
                    <div class="acoes-pizza">
                        <a href="{% url 'editar_pizza' pizza.id %}" class="btn-editar">‚úèÔ∏è Editar</a>
                        <a href="{% url 'excluir_pizza' pizza.id %}" class="btn-excluir" onclick="return confirm('Tem certeza que deseja excluir esta pizza?')">üóëÔ∏è Excluir</a>
                    </div>
                </li>
                {% empty %}
                <li>Nenhuma pizza cadastrada.</li>
                {% endfor %}
            </ul>
        </div>
    </div>



    <script>
        const filtro = document.getElementById("filtro");
        const lista = document.getElementById("lista-pizzas");

        filtro.addEventListener("keyup", function () {
            const termo = filtro.value.toLowerCase();
            const itens = lista.getElementsByTagName("li");

            Array.from(itens).forEach(function (item) {
                const texto = item.textContent.toLowerCase();
                item.style.display = texto.includes(termo) ? "" : "none";
            });
        });
    </script>
{% endblock %}
